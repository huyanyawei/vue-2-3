!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("vue"),require("vue3")):"function"==typeof define&&define.amd?define(["exports","vue","vue3"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).vue23={},e.Vue,e.Vue3)}(this,(function(e,t,n){"use strict";function r(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var i=r(t),o=Symbol();function s(e,t){e[o]||(e[o]=t,Object.defineProperty(e,"parentNode",{get:function(){return this[o]||this.parentElement}}))}var a=function(e,t){var n=e.splice(0);t.append.apply(t,n),n.forEach((function(e){e[o]=void 0}))};function u(e,t){if(this.frag){var n=this.frag.indexOf(t);n>-1&&this.frag.splice(n,0,e)}if(this[f]){var r=this[f].get(t);r&&(t=r[0])}t.before(e),s(e,this)}function c(e){if(this.frag){var t=this.frag.indexOf(e);t>-1&&this.frag.splice(t,1)}var n=this[f];if(n){var r=n.get(e);if(r)return a(r,e),n.delete(e),void(e[o]=void 0)}e.remove()}var f=Symbol(),p={insertBefore:u,removeChild:c},v=Symbol(),d={insertBefore:u,before:function(e){this.frag[0].before(e)},remove:function(){var e=this[v],t=this.frag,n=t.splice(0,t.length,e);n[0].before(this[v]),n.forEach((function(e){return e.remove()}))},removeChild:c,appendChild:function(e){var t=this.frag.length;this.frag[t-1].after(e);var n=this[v];this.frag[0]===n&&(this.frag.splice(0,1),n.remove()),s(e,this),this.frag.push(e)}},h={inserted:function(e){var t=Array.from(e.childNodes),n=e.parentNode,r=document.createComment("");e[v]=r,0===t.length&&t.push(r);var i=document.createDocumentFragment();i.append.apply(i,t),e.replaceWith(i),e.frag=t,function(e,t,n){e[f]||(e[f]=new Map,Object.assign(e,p)),e[f].set(t,n)}(n,e,t),s(e,n),t.forEach((function(t){return s(t,e)})),Object.defineProperty(e,"innerHTML",{set:function(t){var n=document.createElement("div");n.innerHTML=t;var r=e.frag.length;Array.from(n.childNodes).forEach((function(t){return e.appendChild(t)})),n.append.apply(n,e.frag.splice(0,r))},get:function(){return""}}),Object.assign(e,d)},unbind:function(e){a(e.frag,e),e[v].remove()}},l=function(){};function m(e){return{insertBefore:function(t,n){return e.parentNode.insertBefore(t,n||e)},removeAttribute:l,setAttribute:l}}var g=/-(\w)/g;var b={props:["parent","vnode"],created:function(){this.vue2App=void 0},mounted:function(){var e=this,t=this;this.vue2App=new i.default({beforeCreate:function(){this.$parent=t.parent},directives:{frag:h},render:function(t){return t("div",{directives:[{name:"frag"}]},[e.vnode()])},el:this.$el})},beforeUnmount:function(){this.vue2App.$destroy()},render:function(){return this.vue2App&&this.vue2App.$forceUpdate(),n.h("div")}};function y(e,t){for(var n=e;n;){if(n._provided&&n._provided[t])return n._provided[t];n=n.$parent}}var $={inheritAttrs:!1,beforeCreate:function(){if(!(e=this)._uid||!e._isVue)throw new Error("toVue2 must be used to mount a component in a Vue 2 app");var e},provide:function(){return{}},mounted:function(){var e=this,t=this;this.v3app=n.createApp({render:function(){return n.h(e.$options.component,function(e){var t,n=e.$attrs,r=e.$listeners,i=e.$vnode.data,o=Object.assign({},n);for(var s in(i.class||i.staticClass)&&(o.class=[i.class,i.staticClass]),(i.style||i.staticStyle)&&(o.style=[i.style,i.staticStyle]),r)o[(t=s,"&"===t[0]&&(t=t.slice(1)+"Passive"),"~"===t[0]&&(t=t.slice(1)+"Once"),"!"===t[0]&&(t=t.slice(1)+"Capture"),"on"+(t[0].toUpperCase()+t.slice(1).replace(g,(function(e,t){return t?t.toUpperCase():""}))))]=r[s];return o}(e),function(e){var t={},r=function(r){t[r]=function(){return n.h(b,{parent:e,vnode:e.$scopedSlots[r]})}};for(var i in e.$scopedSlots)r(i);return t}(e))},mounted:function(){var e=this;t.v3forceUpdate=function(){return e.$forceUpdate()},t.v3=this._.subTree.component.proxy}}),this.v3app._context.provides=new Proxy({},{has:function(t,n){return y(e,n)},get:function(t,n){return y(e,n)},set:function(t,n,r){return e._provided[n]=r,!0}});var r=this.$el,i=this.v3app.mount(m(r));this.$el=i.$el,r.remove()},beforeDestroy:function(){this.v3app.unmount()},render:function(e){return this.v3forceUpdate&&this.v3forceUpdate(),e("div")}};function O(){return(O=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var A=/\B([A-Z])/g,_=/^on[A-Z]/,j=/(Once|Passive|Capture)$/,C={Once:"~",Passive:"&",Capture:"!"};var x={props:["parent","vnode"],mounted:function(){var e=this;this.vue3App=n.createApp({render:function(){return e.vnode()}}),this.vue3App._context.provides=this.parent._.provides;var t=this.$el;this.vue3App.mount(m(t)),t.remove()},destroyed:function(){this.vue3App.unmount()},render:function(e){return e("div")}};function w(e,t){var n={},r=function(r){n[r]=function(){return e(x,{attrs:{parent:t,vnode:t.$slots[r]}})}};for(var i in t.$slots)r(i);return n}var P={configurable:!0},U={created:function(){if(!(e=this)._||!e._.uid)throw new Error("toVue3 must be used to mount a component in a Vue 3 app");var e;this.v2=void 0},mounted:function(){var e=this,t=this,n=this.$el;this.v2=new i.default({provide:function(){return new Proxy(t._.provides,{getOwnPropertyDescriptor:function(e,t){if(t in e)return P}})},render:function(e){return e(t.$options.component,O({},function(e){var t={style:void 0,class:void 0,on:{},attrs:{},props:{}},n=t.on,r=t.attrs;for(var i in e)if(_.test(i)){var o=i.slice(2);if(j.test(o)){for(var s=void 0;s=o.match(j);)o=C[s[0]]+o.slice(0,-s[0].length);o=o.replace("!~","~!")}n[o=o.replace(A,"-$1").toLowerCase()]=e[i]}else"class"===i||"style"===i?t[i]=e[i]:r[i]=e[i];return t}(t.$attrs),{scopedSlots:w(e,t)}))},mounted:function(){for(var e,r,i=t._,o=i.vnode.el;i.vnode.el===o;)i.vnode.el=this.$el,i.parent&&(i=i.parent);e=n,r=this.$el.parentNode,Object.defineProperty(e,"parentNode",{get:function(){return this.parentElement||r}})},destroyed:function(){this.$el.replaceWith(n)},methods:{exposeProvided:function(t){return Object.assign(e._.provides,t)}},el:n})},beforeUnmount:function(){this.v2.$destroy()},render:function(){return this.v2&&this.v2.$forceUpdate(),n.h("div")}},E={created:function(){this.$root.exposeProvided(this._provided)}};e.toVue2=function(e){var t=Object.create($);return t.component=e,t},e.toVue3=function(e){var t=Object.create(e);t.mixins=[E].concat(e.mixins||[]);var n=Object.create(U);return n.component=t,n},Object.defineProperty(e,"__esModule",{value:!0})}));
